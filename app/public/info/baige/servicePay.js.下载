(function(a){function d(){this.options={type:0,serviceFunctions:"",timeType:0,eventId:""};this.serviceFunction={};this.profession={};this.enterprise={}}function b(e){$("[name='permissionType']").each(function(f){$(this).click(function(){$("[name='permissionType']").removeClass("active");var l=$(this);l.addClass("active");var k=l.data("type"),g=$("[name='permissionPayType']");var j=g.filter("[value='0']"),h=g.filter("[value='1']");l.addClass("active");var i={};if(k==0){j.prop("checked",true).removeAttr("disabled");h.prop("checked",false).attr("disabled","disabled");i.timeType=0}else{if(k==1){h.prop("checked",true).removeAttr("disabled");j.prop("checked",false).attr("disabled","disabled");i.timeType=1}else{if(k==2){j.removeAttr("disabled");h.removeAttr("disabled");i.timeType=$("[name='permissionPayType']:checked").val()}}}i.type=k;e.init(i)})});$("[name='permissionPayType']").each(function(){$(this).click(function(){e.init({timeType:$("[name='permissionPayType']:checked").val()})})})}function c(f){var e=f.serviceFunction,g=f.options.type;if(g==2&&e&&e.fee>0&&e.annualFee>0){$("[name='functionPayFee']").eq(0).html(f.options.timeType==0?e.annualFee:e.fee).parent().show()}else{$("[name='functionPayFee']").eq(0).html(g==1?f.profession.fee:f.enterprise.fee).show()}}d.prototype={init:function(e){this.options=$.extend(true,this.options,e);if(this.options.eventId&&!isNaN(parseInt(this.options.eventId))&&(this.options.eventId+"").indexOf(".")==-1){$("[name='permissionType'][data-type='1']").show()}else{this.options.eventId=""}c(this);return this},loadServiceFunctions:function(g){b(this);var f=this;function e(h){if(h&&h.fee>0&&h.annualFee>0){$("[name='permissionType'][data-type='2']").show().trigger("click");f.init({serviceFunctions:h.serviceFunctionId})}else{$("[name='permissionType'][data-type='0']").trigger("click")}if(h&&h.functionCode=="hotels_and_rooms"){$("[name='permissionType'][data-type='0']").hide();$("[name='permissionType'][data-type='1']").hide();$("#permissionPay_annualFee").hide()}f.serviceFunction=h;c(f)}if(!emptyStr(g)){$.getJSON("/load/service/serviceFunction",{},function(i){var j=i.resultObject.serviceFunctions,h;j.some(function(k){if(k.functionCode==g){h=k;return true}});f.profession=i.resultObject.profession;f.enterprise=i.resultObject.enterprise;e(h)})}else{e()}},enterprisePay:function(){this.submitPay(this.options)},professionPay:function(e){this.options.type=1;this.options.eventId=e;this.submitPay(this.options)},chooseActionsPay:function(f,e){this.options.type=2;this.options.timeType=f;this.options.serviceFunctions=e;this.submitPay(this.options)},submitPay:function(){var e=this.options;var g=e.type,f=e.serviceFunctions,h=e.timeType;if(g==2&&f==""){alertWarningTips("请选择开通的项目");return}if((g==1||(g==2&&h==1))&&emptyStr(e.eventId)){alertWarningTips("请选择需要开通项目的活动");return}$.post("/action/service/submitServiceOrder",{type:g,serviceFunctionIds:f,timeType:h,eventId:e.eventId},function(i){if(i.retStatus==200){a.location.href=i.resultObject}},"json")}};a.ServicePay=new d()})(window);