(function(e){var h=function(){var K='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',p={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:true,flat:false,layout:"full",submit:1,submitText:"OK",height:156,z_index:""},C=function(L,N){var M=f(L);e(N).data("colpick").fields.eq(1).val(M.r).end().eq(2).val(M.g).end().eq(3).val(M.b).end()},o=function(L,M){e(M).data("colpick").fields.eq(4).val(Math.round(L.h)).end().eq(5).val(Math.round(L.s)).end().eq(6).val(Math.round(L.b)).end()},r=function(L,M){e(M).data("colpick").fields.eq(0).val(a(L))},G=function(L,M){e(M).data("colpick").selector.css("backgroundColor","#"+a({h:L.h,s:100,b:100}));e(M).data("colpick").selectorIndic.css({left:parseInt(e(M).data("colpick").height*L.s/100,10),top:parseInt(e(M).data("colpick").height*(100-L.b)/100,10)})},l=function(L,M){e(M).data("colpick").hue.css("top",parseInt(e(M).data("colpick").height-e(M).data("colpick").height*L.h/360,10))},k=function(L,M){e(M).data("colpick").currentColor.css("backgroundColor","#"+a(L))},v=function(L,M){e(M).data("colpick").newColor.css("backgroundColor","#"+a(L))},t=function(M){var N=e(this).parent().parent(),L;if(this.parentNode.className.indexOf("_hex")>0){N.data("colpick").color=L=g(z(this.value));C(L,N.get(0));o(L,N.get(0))}else{if(this.parentNode.className.indexOf("_hsb")>0){N.data("colpick").color=L=A({h:parseInt(N.data("colpick").fields.eq(4).val(),10),s:parseInt(N.data("colpick").fields.eq(5).val(),10),b:parseInt(N.data("colpick").fields.eq(6).val(),10)});C(L,N.get(0));r(L,N.get(0))}else{N.data("colpick").color=L=b(m({r:parseInt(N.data("colpick").fields.eq(1).val(),10),g:parseInt(N.data("colpick").fields.eq(2).val(),10),b:parseInt(N.data("colpick").fields.eq(3).val(),10)}));r(L,N.get(0));o(L,N.get(0))}}G(L,N.get(0));l(L,N.get(0));v(L,N.get(0));N.data("colpick").onChange.apply(N.parent(),[L,a(L),f(L),N.data("colpick").el,0])},y=function(L){e(this).parent().removeClass("colpick_focus")},u=function(){e(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus");e(this).parent().addClass("colpick_focus")},j=function(L){L.preventDefault?L.preventDefault():L.returnValue=false;var N=e(this).parent().find("input").focus();var M={el:e(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:(this.parentNode.className.indexOf("_hsb")>0?100:255),y:L.pageY,field:N,val:parseInt(N.val(),10),preview:e(this).parent().parent().data("colpick").livePreview};e(document).mouseup(M,x);e(document).mousemove(M,D)},D=function(L){L.data.field.val(Math.max(0,Math.min(L.data.max,parseInt(L.data.val-L.pageY+L.data.y,10))));if(L.data.preview){t.apply(L.data.field.get(0),[true])}return false},x=function(L){t.apply(L.data.field.get(0),[true]);L.data.el.removeClass("colpick_slider").find("input").focus();e(document).off("mouseup",x);e(document).off("mousemove",D);return false},J=function(M){M.preventDefault?M.preventDefault():M.returnValue=false;var N={cal:e(this).parent(),y:e(this).offset().top};e(document).on("mouseup touchend",N,n);e(document).on("mousemove touchmove",N,q);var L=((M.type=="touchstart")?M.originalEvent.changedTouches[0].pageY:M.pageY);t.apply(N.cal.data("colpick").fields.eq(4).val(parseInt(360*(N.cal.data("colpick").height-(L-N.y))/N.cal.data("colpick").height,10)).get(0),[N.cal.data("colpick").livePreview]);return false},q=function(M){var L=((M.type=="touchmove")?M.originalEvent.changedTouches[0].pageY:M.pageY);t.apply(M.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(M.data.cal.data("colpick").height-Math.max(0,Math.min(M.data.cal.data("colpick").height,(L-M.data.y))))/M.data.cal.data("colpick").height,10)).get(0),[M.data.preview]);return false},n=function(L){C(L.data.cal.data("colpick").color,L.data.cal.get(0));r(L.data.cal.data("colpick").color,L.data.cal.get(0));e(document).off("mouseup touchend",n);e(document).off("mousemove touchmove",q);return false},E=function(M){M.preventDefault?M.preventDefault():M.returnValue=false;var N={cal:e(this).parent(),pos:e(this).offset()};N.preview=N.cal.data("colpick").livePreview;e(document).on("mouseup touchend",N,I);e(document).on("mousemove touchmove",N,i);var O,L;if(M.type=="touchstart"){pageX=M.originalEvent.changedTouches[0].pageX,L=M.originalEvent.changedTouches[0].pageY}else{pageX=M.pageX;L=M.pageY}t.apply(N.cal.data("colpick").fields.eq(6).val(parseInt(100*(N.cal.data("colpick").height-(L-N.pos.top))/N.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-N.pos.left)/N.cal.data("colpick").height,10)).get(0),[N.preview]);return false},i=function(M){var N,L;if(M.type=="touchmove"){pageX=M.originalEvent.changedTouches[0].pageX,L=M.originalEvent.changedTouches[0].pageY}else{pageX=M.pageX;L=M.pageY}t.apply(M.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(M.data.cal.data("colpick").height-Math.max(0,Math.min(M.data.cal.data("colpick").height,(L-M.data.pos.top))))/M.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(Math.max(0,Math.min(M.data.cal.data("colpick").height,(pageX-M.data.pos.left))))/M.data.cal.data("colpick").height,10)).get(0),[M.data.preview]);return false},I=function(L){C(L.data.cal.data("colpick").color,L.data.cal.get(0));r(L.data.cal.data("colpick").color,L.data.cal.get(0));e(document).off("mouseup touchend",I);e(document).off("mousemove touchmove",i);return false},w=function(M){var N=e(this).parent();var L=N.data("colpick").color;N.data("colpick").origColor=L;k(L,N.get(0));N.data("colpick").onSubmit(L,a(L),f(L),N.data("colpick").el)},H=function(M){M.stopPropagation();var Q=e("#"+e(this).data("colpickId"));Q.data("colpick").onBeforeShow.apply(this,[Q.get(0)]);var R=e(this).offset();var P=R.top+this.offsetHeight;var O=R.left;var N=B();var L=Q.width();if(O+L>N.l+N.w){O-=L}Q.css({left:O+"px",top:P+"px"});if(Q.data("colpick").onShow.apply(this,[Q.get(0)])!=false){Q.show()}e("html").mousedown({cal:Q},s);Q.mousedown(function(S){S.stopPropagation()})},s=function(L){if(L.data.cal.data("colpick").onHide.apply(this,[L.data.cal.get(0)])!=false){L.data.cal.hide()}e("html").off("mousedown",s)},B=function(){var L=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(L?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(L?document.documentElement.clientWidth:document.body.clientWidth)}},A=function(L){return{h:Math.min(360,Math.max(0,L.h)),s:Math.min(100,Math.max(0,L.s)),b:Math.min(100,Math.max(0,L.b))}},m=function(L){return{r:Math.min(255,Math.max(0,L.r)),g:Math.min(255,Math.max(0,L.g)),b:Math.min(255,Math.max(0,L.b))}},z=function(N){var L=6-N.length;if(L>0){var O=[];for(var M=0;M<L;M++){O.push("0")}O.push(N);N=O.join("")}return N},F=function(){var M=e(this).parent();var L=M.data("colpick").origColor;M.data("colpick").color=L;C(L,M.get(0));r(L,M.get(0));o(L,M.get(0));G(L,M.get(0));l(L,M.get(0));v(L,M.get(0))};return{init:function(L){L=e.extend({},p,L||{});if(typeof L.color=="string"){L.color=g(L.color)}else{if(L.color.r!=undefined&&L.color.g!=undefined&&L.color.b!=undefined){L.color=b(L.color)}else{if(L.color.h!=undefined&&L.color.s!=undefined&&L.color.b!=undefined){L.color=A(L.color)}else{return this}}}return this.each(function(){if(!e(this).data("colpickId")){var W=e.extend({},L);W.origColor=L.color;var O="collorpicker_"+parseInt(Math.random()*1000);e(this).data("colpickId",O);var N=e(K).attr("id",O);N.addClass("colpick_"+W.layout+(W.submit?"":" colpick_"+W.layout+"_ns"));if(W.colorScheme!="light"){N.addClass("colpick_"+W.colorScheme)}N.find("div.colpick_submit").html(W.submitText).click(w);W.fields=N.find("input").change(t).blur(y).focus(u);N.find("div.colpick_field_arrs").mousedown(j).end().find("div.colpick_current_color").click(F);W.selector=N.find("div.colpick_color").on("mousedown touchstart",E);W.selectorIndic=W.selector.find("div.colpick_selector_outer");W.el=this;W.hue=N.find("div.colpick_hue_arrs");var V=W.hue.parent();var T=navigator.userAgent.toLowerCase();var P=navigator.appName==="Microsoft Internet Explorer";var Q=P?parseFloat(T.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;var R=(P&&Q<10);var U=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(R){var S,M;for(S=0;S<=11;S++){M=e("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+U[S]+", endColorstr="+U[S+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+U[S]+", endColorstr="+U[S+1]+')";');V.append(M)}}else{stopList=U.join(",");V.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")}N.find("div.colpick_hue").on("mousedown touchstart",J);W.newColor=N.find("div.colpick_new_color");W.currentColor=N.find("div.colpick_current_color");N.data("colpick",W);C(W.color,N.get(0));o(W.color,N.get(0));r(W.color,N.get(0));l(W.color,N.get(0));G(W.color,N.get(0));k(W.color,N.get(0));v(W.color,N.get(0));if(L.z_index!=""){N.css({"z-index":L.z_index})}if(W.flat){N.appendTo(this).show();N.css({position:"relative",display:"block"})}else{N.appendTo(document.body);e(this).on(W.showEvent,H);N.css({position:"absolute"})}}})},showPicker:function(){return this.each(function(){if(e(this).data("colpickId")){H.apply(this)}})},hidePicker:function(){return this.each(function(){if(e(this).data("colpickId")){e("#"+e(this).data("colpickId")).hide()}})},setColor:function(L,M){M=(typeof M==="undefined")?1:M;if(typeof L=="string"){L=g(L)}else{if(L.r!=undefined&&L.g!=undefined&&L.b!=undefined){L=b(L)}else{if(L.h!=undefined&&L.s!=undefined&&L.b!=undefined){L=A(L)}else{return this}}}return this.each(function(){if(e(this).data("colpickId")){var N=e("#"+e(this).data("colpickId"));N.data("colpick").color=L;N.data("colpick").origColor=L;C(L,N.get(0));o(L,N.get(0));r(L,N.get(0));l(L,N.get(0));G(L,N.get(0));v(L,N.get(0));N.data("colpick").onChange.apply(N.parent(),[L,a(L),f(L),N.data("colpick").el,1]);if(M){k(L,N.get(0))}}})}}}();var c=function(i){var i=parseInt(((i.indexOf("#")>-1)?i.substring(1):i),16);return{r:i>>16,g:(i&65280)>>8,b:(i&255)}};var g=function(i){return b(c(i))};var b=function(k){var j={h:0,s:0,b:0};var l=Math.min(k.r,k.g,k.b);var i=Math.max(k.r,k.g,k.b);var m=i-l;j.b=i;j.s=i!=0?255*m/i:0;if(j.s!=0){if(k.r==i){j.h=(k.g-k.b)/m}else{if(k.g==i){j.h=2+(k.b-k.r)/m}else{j.h=4+(k.r-k.g)/m}}}else{j.h=-1}j.h*=60;if(j.h<0){j.h+=360}j.s*=100/255;j.b*=100/255;return j};var f=function(i){var k={};var o=i.h;var n=i.s*255/100;var j=i.b*255/100;if(n==0){k.r=k.g=k.b=j}else{var p=j;var m=(255-n)*j/255;var l=(p-m)*(o%60)/60;if(o==360){o=0}if(o<60){k.r=p;k.b=m;k.g=m+l}else{if(o<120){k.g=p;k.b=m;k.r=p-l}else{if(o<180){k.g=p;k.r=m;k.b=m+l}else{if(o<240){k.b=p;k.r=m;k.g=p-l}else{if(o<300){k.b=p;k.g=m;k.r=m+l}else{if(o<360){k.r=p;k.g=m;k.b=p-l}else{k.r=0;k.g=0;k.b=0}}}}}}}return{r:Math.round(k.r),g:Math.round(k.g),b:Math.round(k.b)}};var d=function(i){var j=[i.r.toString(16),i.g.toString(16),i.b.toString(16)];e.each(j,function(k,l){if(l.length==1){j[k]="0"+l}});return j.join("")};var a=function(i){return d(f(i))};e.fn.extend({colpick:h.init,colpickHide:h.hidePicker,colpickShow:h.showPicker,colpickSetColor:h.setColor});e.extend({colpick:{rgbToHex:d,rgbToHsb:b,hsbToHex:a,hsbToRgb:f,hexToHsb:g,hexToRgb:c}})})(jQuery);